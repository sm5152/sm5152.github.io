(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["sub_carttoorder_packge"],{"0123":function(t,e,s){"use strict";s("5969")},"20d8":function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"discount-detail"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.goodsDiscountInfo.discount,expression:"goodsDiscountInfo.discount"}],staticClass:"discount-item"},[e("img",{staticClass:"detail-icon",attrs:{src:t.$store.state.imageUrl+"/icon/bag_icon.png",alt:""}}),e("div",{staticClass:"detail-desc"},[t._v(" "+t._s(t.$t("item_details_discount"))+" "+t._s(t._f("numPercent")(t.goodsDiscountInfo.discount))+" ")])]),t.isOrder||t.sendDiscountInfo.discount?e("div",{staticClass:"discount-item"},[e("img",{staticClass:"detail-icon",attrs:{src:t.$store.state.imageUrl+"/icon/plane_icon.png",alt:""}}),e("div",{staticClass:"detail-desc"},[e("span",[t._v(t._s(t.$t("item_details_send_discount"))+"("+t._s(t.curSym)+t._s(t.curSendMoney)+")")]),t._v("  "),e("el-tooltip",{attrs:{placement:"right"}},[e("div",{staticStyle:{"max-width":"380px"},attrs:{slot:"content"},slot:"content"},[e("p",{directives:[{name:"show",rawName:"v-show",value:t.sendDiscountInfo.endTime,expression:"sendDiscountInfo.endTime"}]},[t._v(t._s(t.$t("item_details_send_discount_end"))+"："+t._s(t._f("formatDate")(t.sendDiscountInfo.endTime)))]),e("div",[t._v(t._s(t.$t("item_details_discount_rules"))+"：")]),e("i18n",{attrs:{path:"item_details_discount_rules_desc",tag:"li"}},[e("span",{attrs:{slot:"curSendMoney"},slot:"curSendMoney"},[t._v(t._s(t.curSym)+t._s(t.curSendMoney))]),e("span",{staticStyle:{color:"#ff2840"},attrs:{slot:"maxSendDiscount"},slot:"maxSendDiscount"},[t._v(t._s(t._f("numPercent")(t.sendDiscountInfo.max_send_discount)))])])],1),e("a-icon",{attrs:{type:"question-circle"}})],1)],1)]):t._e()])},o=[],r={props:{goodsDiscountInfo:{type:Object,default:()=>({})},sendDiscountInfo:{type:Object,default:()=>({})},isOrder:{default:()=>!1},curSym:{type:String,default:"￥"},curSendMoney:{type:Number,default:0}},filters:{numPercent(t){return 100*Number(t)+"%"}}},a=r,n=(s("0123"),s("2877")),c=Object(n["a"])(a,i,o,!1,null,"014e4d2f",null);e["a"]=c.exports},3339:function(t,e,s){"use strict";s.d(e,"f",(function(){return o})),s.d(e,"g",(function(){return r})),s.d(e,"d",(function(){return a})),s.d(e,"e",(function(){return n})),s.d(e,"b",(function(){return c})),s.d(e,"c",(function(){return d})),s.d(e,"a",(function(){return l}));var i=s("4ec3");function o(t={}){return Object(i["a"])("/api/pic/exPicTmplList",t,!0)}function r(t={}){return Object(i["a"])("/api/pic/exPicTmplSave",t,!0)}function a(t={}){return Object(i["a"])("/api/pic/exPicTmplDel",t,!0)}function n(t={}){return Object(i["a"])("/api/pic/exPicTmplItem",t,!0)}function c(t={}){return Object(i["a"])("/api/pic/exPicOrdersCancel",t,!0)}function d(t={}){return Object(i["a"])("/api/pic/exPicOrdersEdit",t,!0)}function l(t={}){return Object(i["a"])("/api/pic/exPicOrdersAdd",t,!0)}},"4ada":function(t,e,s){},5969:function(t,e,s){},"6be6":function(t,e,s){"use strict";s("4ada")},"7b91":function(t,e,s){},a11b1:function(t,e,s){"use strict";s("7b91")},aa8d:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"carttoorder"}},[e("common-header"),e("div",{attrs:{id:"confirm-order"}},[e("h2",[t._v(t._s(t.$t("carttoorder_confirm_order")))]),e("div",{staticClass:"order-box"},[e("div",{staticClass:"good-list"},[e("p",{staticClass:"title-p"},[t._v(" "+t._s(t.$t("carttoorder_confirm_product_info"))+" "),e("router-link",{staticClass:"rout-link",attrs:{to:"/center/cart"}},[t._v(t._s(t.$t("carttoorder_back_cart")))])],1),e("div",{staticClass:"headline"},[e("tr",[e("td",[t._v(t._s(t.$t("carttoorder_product_detail")))]),e("td",[t._v(t._s(t.$t("carttoorder_remark")))]),e("td",[t._v(t._s(t.$t("carttoorder_unit_price")))]),e("td",[t._v(t._s(t.$t("carttoorder_amount")))]),e("td",[t._v(t._s(t.$t("carttoorder_add_service")))]),e("td",[t._v(t._s(t.$t("carttoorder_total")))])])]),e("cartToOrderTable",{ref:"cartToOrderTableRef",attrs:{exPicList:t.exPicList}})],1)]),e("div",{staticClass:"judge"}),e("div",{staticClass:"bottom_fix",class:{isFixed:t.fixedType&&!t.isMobile}},[e("div",{staticClass:"confirm-tip"},[e("p",{staticClass:"clause"},[e("router-link",{attrs:{to:"/service/help/question?id=44&cid=66",target:"_blank"}},[t._v(t._s(t.$t("carttoorder_clause1")))]),e("router-link",{attrs:{to:"/service/help/question?id=40&cid=63",target:"_blank"}},[t._v(t._s(t.$t("carttoorder_clause2")))]),e("router-link",{attrs:{to:"/service/help/question?id=87",target:"_blank"}},[t._v(t._s(t.$t("carttoorder_clause3")))]),e("router-link",{attrs:{to:"/service/help/question?id=48",target:"_blank"}},[t._v(t._s(t.$t("carttoorder_clause4")))])],1),e("p",{staticClass:"checkbox"},[t.agreeClause?e("a-checkbox",{model:{value:t.agreeClause,callback:function(e){t.agreeClause=e},expression:"agreeClause"}},[e("span",[t._v(t._s(t.$t("carttoorder_agree_check")))])]):e("el-tooltip",{attrs:{placement:"top"},model:{value:t.isShowToolTip,callback:function(e){t.isShowToolTip=e},expression:"isShowToolTip"}},[e("template",{slot:"content"},[e("span",[t._v(t._s(t.$t("item_details_tooltip_title")))])]),e("a-checkbox",{model:{value:t.agreeClause,callback:function(e){t.agreeClause=e},expression:"agreeClause"}},[t._v(t._s(t.$t("carttoorder_agree_check")))])],2)],1),e("div",{staticClass:"tip"},[e("p",[t._v(t._s(t.$t("carttoorder_reminder")))]),t._v(" "+t._s(t.$t("carttoorder_reminder_text"))+" ")])]),e("div",{staticClass:"submit-order"},[e("a-spin",{attrs:{spinning:t.isLoading}},[e("button",{staticClass:"cancel-btn",on:{click:t.back}},[t._v(" "+t._s(t.$t("carttoorder_back"))+" ")])]),e("a-spin",{attrs:{spinning:t.isLoading}},[e("button",{staticClass:"submit-btn",class:t.agreeClause?"":"disabled",on:{click:t.handleSubmit}},[t._v(" "+t._s(t.$t("carttoorder_submit_order"))+" ")])])],1)])]),e("common-footer")],1)},o=[],r=(s("14d9"),s("e9f5"),s("ab43"),s("5087"),s("d9a2")),a=s("46bb"),n=function(){var t=this,e=t._self._c;return e("div",[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],attrs:{id:"cartToOrderCard"}},[t._l(t.goodsList,(function(s){return e("div",{key:s.goods_seller,staticClass:"cart-box"},[e("div",{staticClass:"warehouse"},[e("div",{staticClass:"warehouse-box"},[e("i"),e("a",{attrs:{href:s.seller_url,target:"_blank"}},[t._v(t._s(s.goods_seller))]),e("span",[t._v(t._s(s.warehouse_str))])]),e("div",{staticClass:"total"},[t._v("  "+t._s(t.$t("carttoorder_domestic_freight"))+" "),e("span",[t._v(t._s(t.orderInfo.cur_sym)+t._s(s.cur_send_money))])])]),e("div",{staticClass:"info"},t._l(s.cart_list,(function(s){return e("div",{key:s.id},[e("div",{staticClass:"info-card"},[e("div",{staticClass:"detail-box"},[e("div",{staticClass:"img-box"},[e("img",{attrs:{src:s.goodsimg,alt:""}})]),e("div",{staticClass:"detail"},[e("div",{staticClass:"ellipsis3",attrs:{title:s.goodsname}},[e("router-link",{attrs:{to:{path:"/item/details",query:{url:s.goodsurl}},target:"_blank"}},[t._v(" "+t._s(s.goodsname)+" ")])],1),e("div",{staticClass:"ellipsis3 span-info"},[t._v(t._s(s.skuname))])])]),e("div",{staticClass:"remark card-box"},[e("span",[t._v(t._s(s.goodsremark))]),e("i",{on:{click:function(e){t.showRemark=!0,t.remark=s.goodsremark,t.remarkList=s}}})]),e("div",{staticClass:"price card-box"},[s.cur_goodsprice===s.cur_original_price?e("span",[t._v(t._s(t.orderInfo.cur_sym)+t._s(s.cur_goodsprice))]):e("div",{staticClass:"discount-price"},[e("span",{staticClass:"goods-price"},[t._v(t._s(t.orderInfo.cur_sym)+t._s(s.cur_original_price))]),e("span",{staticClass:"original-price"},[t._v(t._s(t.orderInfo.cur_sym)+t._s(s.cur_goodsprice))])])]),e("div",{staticClass:"count card-box"},[e("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:1,max:999},on:{change:(e,i)=>t.edit(e,1,s)},model:{value:s.goodsnum,callback:function(e){t.$set(s,"goodsnum",e)},expression:"list.goodsnum"}})],1),e("div",{staticClass:"photo card-box",on:{click:function(e){return t.handleHdPhoto(s)}}},[e("a-icon",{attrs:{type:"camera"}}),e("span",{staticClass:"photo-text"},[t._v(t._s(t.$t("carttoorder_extra_photo")))])],1),e("div",{staticClass:"sum card-box"},[t._v(t._s(t.orderInfo.cur_sym)+t._s(s.cur_goodsprice_total))])]),s.goods_discount_info&&s.goods_discount_info.discount||s.send_discount_info&&s.send_discount_info.discount?e("DiscountItem",{staticClass:"cart-discount",attrs:{goodsDiscountInfo:s.goods_discount_info,sendDiscountInfo:s.send_discount_info,curSym:t.orderInfo.cur_sym,curSendMoney:s.cur_send_dis_money}}):t._e(),e("div",{staticClass:"ex-pic-table"},[e("div",[t._v(t._s(t.$t("carttoorder_extra_photo"))+"：")]),e("span",{staticStyle:{color:"#ff2840"}},[t._v(t._s(t.currentExPic(s.id).length))])])],1)})),0),e("div",{staticClass:"merchant"},[e("p",[t._v(t._s(t.$t("carttoorder_shop_total"))),e("span",[t._v(t._s(t.orderInfo.cur_sym)+t._s(s.cur_total_money))])])])])})),e("div",{staticClass:"total-money"},[e("p",{staticClass:"service-fee"},[t._v(t._s(t.$t("carttoorder_total_service_fee"))+" "),e("span",[t._v(t._s(t.orderInfo.cur_sym)+t._s(t.orderInfo.cur_service_fee))])]),e("em",[t._v(t._s(t.orderInfo.cur_sym)+t._s(t.orderInfo.cur_total_money))]),e("p",{staticClass:"title"},[t._v(t._s(t.$t("carttoorder_total_tip1"))+" "),e("span",[t._v(" （"+t._s(t.$t("carttoorder_total_tip2"))+"） ")])])])],2),e("a-modal",{attrs:{title:t.$t("carttoorder_cart_remark_title"),centered:"",okText:t.$t("confirm_ok_text"),okType:"danger"},on:{ok:function(e){return t.edit(t.remark,2,t.remarkList)}},model:{value:t.showRemark,callback:function(e){t.showRemark=e},expression:"showRemark"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],staticClass:"input-text",attrs:{rows:"8",placeholder:t.$t("carttoorder_cart_remark")},domProps:{value:t.remark},on:{input:function(e){e.target.composing||(t.remark=e.target.value)}}})]),e("a-modal",{staticClass:"tip-modal",attrs:{centered:"",okText:t.$t("confirm_ok_text"),cancelText:t.$t("confirm_cancel_text"),destroyOnClose:"",okType:"danger"},on:{ok:function(e){t.showTip=!1}},model:{value:t.showTip,callback:function(e){t.showTip=e},expression:"showTip"}},[e("div",{staticClass:"tip-text",domProps:{innerHTML:t._s(t.tipText)}}),e("a-checkbox",{staticClass:"tip-check",on:{change:t.tipPrompt}},[t._v(t._s(t.$t("carttoorder_cart_tip_prompt")))])],1),e("photoModal",{ref:"photoModalRef",on:{onSuccess:t.photoSubmit}})],1)},c=[],d=(s("f665"),s("7d54"),s("cc33")),l=s("2166"),u=function(){var t=this,e=t._self._c;return e("div",[e("a-modal",{attrs:{title:t.$t("center_custom_photo"),visible:t.visible,maskClosable:!1,width:800,okType:"danger",okText:t.$t("confirm_ok_text"),cancelText:t.$t("confirm_cancel_text")},on:{ok:t.handleSetTmpl,cancel:function(e){t.visible=!1},click:function(e){t.popoverShow=!1}}},[e("div",{staticClass:"goods-box"},[e("div",{staticClass:"detail-box"},[e("div",{staticClass:"img-box"},[e("img",{attrs:{src:t.goodsInfo.goodsimg,alt:""}})]),e("div",{staticClass:"detail"},[e("div",{staticClass:"ellipsis2",attrs:{title:t.goodsInfo.goodsname}},[e("router-link",{attrs:{to:{path:"/item/details",query:{url:t.goodsInfo.goodsurl}},target:"_blank"}},[t._v(" "+t._s(t.goodsInfo.goodsname)+" ")])],1),e("div",{staticClass:"span-info"},[t._v(t._s(t.goodsInfo.skuname))]),e("div",{staticClass:"goodsnum"},[t._v("x "+t._s(t.goodsInfo.goodsnum))])])])]),e("a-form-model",{directives:[{name:"loading",rawName:"v-loading",value:t.editIng,expression:"editIng"}],ref:"ruleForm",attrs:{layout:"vertical",model:t.formItem,rules:t.rules}},[e("a-form-model-item",{attrs:{label:t.$t("center_custom_photo_tmpl_count")}},[e("el-input-number",{staticStyle:{width:"40%"},attrs:{min:1,max:100,"step-strictly":!0},on:{change:t.tmplCountChange},model:{value:t.tmplCount,callback:function(e){t.tmplCount="string"===typeof e?e.trim():e},expression:"tmplCount"}})],1),e("p",{staticStyle:{color:"#ff2840"}},[t._v(t._s(t.$t("carttoorder_photo_modal_count_tip")))]),e("div",{staticClass:"tmpl-box"},[e("span",{staticClass:"label"},[t._v(t._s(t.$t("carttoorder_photo_modal_tmpl"))+" ")]),e("ul",t._l(t.tmplList,(function(s){return e("li",{key:s.id,on:{click:function(e){return t.swTmpl(s)}}},[t._v(t._s(s.title))])})),0)]),e("a-form-model-item",[e("div",{staticClass:"photo-require-box"},t._l(t.infos,(function(s,i){return e("div",{key:i,staticClass:"require-item"},[e("div",[t._v(t._s(t.$t("center_custom_photo_tmpl_requirement"))+t._s(i+1))]),e("div",{staticClass:"tmpl-item"},[e("a-input",{staticClass:"requirement",attrs:{type:"textarea",placeholder:t.$t("center_custom_photo_tmpl_requirement_placeholder")},model:{value:s.requirement,callback:function(e){t.$set(s,"requirement",e)},expression:"item.requirement"}}),e("a-upload",{staticClass:"pic-uploader",attrs:{name:"tmplPic","list-type":"picture-card","file-list":s.referencePic?[{uid:i,url:s.referencePic,status:"done",name:"image.png"}]:[],action:"",customRequest:e=>t.customRequest(e,s),remove:e=>t.removePhoto(e,s)}},[""===s.referencePic?e("div",[e("a-icon",{staticClass:"upload-icon",attrs:{type:t.uploading?"loading":"plus"}})],1):t._e()]),e("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.infos.length>1,expression:"infos.length > 1"}],staticClass:"delete-icon",attrs:{type:"delete"},on:{click:function(e){return t.deleteTmpl(i)}}})],1),s.isEmpty?e("div",{staticClass:"err-msg"},[t._v(" "+t._s(t.$t("center_custom_photo_add_tmpl_requirement_err_msg"))+" ")]):t._e()])})),0)])],1)],1)],1)},_=[],m=s("3339"),p=s("7024"),h={data(){return{visible:!1,goodsInfo:{},tmplList:[],formItem:{tmplId:"",title:""},tmplCount:1,infos:[{infoId:"",requirement:"",referencePic:""}],rules:{title:[{required:!0,message:this.$t("center_custom_modal_rules_title"),trigger:"blur"}]},uploading:!1,editIng:!1}},mounted(){this.getTmplList()},methods:{getTmplList(){Object(m["f"])().then(t=>{this.tmplList=t.data.list}).catch(()=>{})},showModal(t,e){this.visible=!0,this.goodsInfo=t,this.infos=e?[...e]:[{infoId:"",requirement:"",referencePic:""}]},swTmpl(t){this.infos=t.infos.map(t=>({infoId:t.id,requirement:t.requirement,referencePic:t.reference_pic})),this.tmplCount=this.infos.length},customRequest(t,e){const{file:s}=t;let i={type:"etc",image:s};this.uploading=!0,Object(p["c"])(i).then(t=>{this.uploading=!1,this.$set(e,"referencePic",t.data.url)}).catch(t=>{this.uploading=!1})},removePhoto(t,e){return this.$set(e,"referencePic",""),!0},deleteTmpl(t){this.infos.splice(t,1),this.tmplCount=this.infos.length},handleSetTmpl(){let t=!0;this.infos.forEach(e=>{""===e.requirement?(this.$set(e,"isEmpty",!0),t=!1):this.$delete(e,"isEmpty")}),t&&(this.$emit("onSuccess",{exPics:this.infos,cartId:this.goodsInfo.id}),this.visible=!1)},tmplCountChange(t,e){let s=t-e,i={infoId:"",requirement:"",referencePic:""};if(s>0)for(let o=0;o<s;o++)this.infos.push(i);else s<0&&this.infos.splice(s)}}},f=h,v=(s("6be6"),s("2877")),g=Object(v["a"])(f,u,_,!1,null,"66dcd32a",null),b=g.exports,C=s("20d8"),k={props:["exPicList"],components:{photoModal:b,DiscountItem:C["a"]},name:"cartToOrderCard",data(){return{goodsList:[],orderInfo:{},showRemark:!1,remark:"",remarkList:{},timeOut:null,tipText:"",showTip:!1,cartIds:[],cartId:"",key:0,picCount:0,value:null,isLoading:!1}},computed:{isTips(){return"true"===Object(d["c"])(d["a"].ENTER_CART_TO_ORDER)}},mounted(){let t=this.$route.query.csk;this.cartIds=JSON.parse(Object(d["d"])(t)),Object(d["c"])(d["a"].ENTER_CART_TO_ORDER)||Object(d["i"])(d["a"].ENTER_CART_TO_ORDER,!1),this.isTips||(this.showTip=!0),this.getOrder()},methods:{getOrder(){if(null===this.cartIds||0===this.cartIds.length)return this.$message.warning("The order is invalid!"),void this.$router.push({path:"/center/cart",query:{}});this.isLoading=!0;let t={};""!==this.cartId&&0!==this.key&&(t.cartId=this.cartId,t.key=this.key,t.value=this.value),t.cartIds=this.cartIds,t.getTips=this.showTip,t.exPicCount=this.picCount,Object(l["f"])(t).then(t=>{let e=t.data;this.goodsList=e.group,this.orderInfo=e,this.showTip&&(this.tipText=e.tips),this.showRemark&&(this.$message.success("Modify remarks successful"),this.showRemark=!1),0===this.goodsList.length&&(this.$message.warning("No order information available!"),this.$router.push({path:"/center/cart",query:""})),this.isLoading=!1}).catch(t=>{this.isLoading=!1,this.showRemark=!1})},edit(t,e,s){this.timeOut&&1===e&&clearTimeout(this.timeOut),this.timeOut=setTimeout(()=>{this.cartId=s.id,this.key=e,this.value=t,this.getOrder()},1e3)},handleHdPhoto(t){let e=null;0!==this.currentExPic(t.id).length&&(e=this.currentExPic(t.id)),this.$nextTick(()=>{this.$refs.photoModalRef.showModal(t,e)})},photoSubmit(t){let e="",s=0;this.exPicList.forEach(i=>{i.cartId===t.cartId&&(this.$set(i,"exPics",t.exPics),e=t.cartId),s+=i.exPics.length}),this.picCount=s,this.getOrder()},currentExPic(t){let e=this.exPicList.find(e=>e.cartId===t);return e.exPics||[]},tipPrompt(t){Object(d["i"])(d["a"].ENTER_CART_TO_ORDER,t.target.checked)}}},x=k,y=(s("a11b1"),Object(v["a"])(x,n,c,!1,null,"091e993d",null)),T=y.exports,$={name:"carttoorder",data(){return{fixedType:!1,isShowToolTip:!1,agreeClause:!1,isLoading:!1,exPicList:[]}},components:{commonHeader:r["a"],commonFooter:a["a"],cartToOrderTable:T},watch:{agreeClause(t){Object(d["i"])(d["a"].AGREECLAUSE,t)}},mounted(){window.addEventListener("scroll",this.handleScroll);const t=Object(d["c"])(d["a"].AGREECLAUSE);"AGREECLAUSE"!==t&&(this.agreeClause="true"===t);let e=this.$route.query.csk,s=JSON.parse(Object(d["d"])(e));this.exPicList=s.map(t=>({cartId:t,exPics:[]})),this.$nextTick(()=>{this.handleScroll()})},computed:{isMobile(){let t=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/);return t}},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{handleScroll(){let t=document.documentElement.offsetHeight,e=document.querySelector(".judge").getBoundingClientRect().top;this.fixedType=t<e},handleSubmit(){this.agreeClause?this.submitOrder():this.isShowToolTip=!0},submitOrder(){let t={cartInfos:this.exPicList};this.isLoading=!0,Object(l["i"])(t).then(t=>{let e=t.data.tradesn;this.$router.push({path:"/pay",query:{key:e}}),this.isLoading=!1}).catch(t=>{this.isLoading=!1})},back(){this.$router.go(-1)}}},I=$,w=(s("bea1"),Object(v["a"])(I,i,o,!1,null,"6ad79255",null));e["default"]=w.exports},aa9d:function(t,e,s){},bea1:function(t,e,s){"use strict";s("aa9d")}}]);